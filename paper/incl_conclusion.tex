%!TEX root = main.tex

\section{Conclusion} 

\added[id=ALB]{Capturing branch switching phenomena across stability transitions is not an automatic feature of approximate numerical methods. They rely on approximate information about the Hessian of the energy functional, as a consequence these methods do not guarantee to systematically detect transitions between local minima when stability is lost. 
Indeed, this requires a careful determination of the zero-eigenmodes that render singular the exact nonlinear Hessian, which is typically not available in general purpose first order numerical algorithms.
In practice, without such information, critical loads for equilibrium transitions become algorithm-dependant and are not consistent with closed-form solutions of the exact evolution problem.
% 
% 
Further work: characterisation of bifurcation points, conditions for stability exchange, local features of the energy landscape, qualitative features of constrained systems with respect to canonical representations of bifurcations
% 
future work: thorough energy blow up and reduction at bifurcation points
}

...
%: (i) compute a descent direction $\mathbf{p}_k$ by solving $B_k \mathbf{p}_k = -\nabla f(\mathbf{x}_k)$, (ii) define a one-dimensional function $h(\alpha_k) = f(\mathbf{X}_k + \alpha_k \mathbf{p}_k)$, representing the function value on the descent direction given the step-size, (iii) find an $\alpha_k$ that minimizes $h$ over $\alpha_k \in \mathbb{R}_+$, (iv) set $\mathbf{s}_k = \alpha_k \mathbf{p}_k$ and update $\mathbf{X}_{k+1} = \mathbf{X}_k + \mathbf{s}_k$, (vi) set $\mathbf{y}_k = \nabla f(\mathbf{X}_{k+1}) - \nabla f(\mathbf{X}_k)$, (vii) set $B_{k+1} = B_k + \frac{\mathbf{y}_k \mathbf{y}_k^T}{\mathbf{y}_k^T \mathbf{s}_k} - \frac{B_k \mathbf{s}_k \mathbf{s}_k^T B_k^T}{\mathbf{s}_k^T B_k \mathbf{s}_k}.$
%Minimizing the energy functionals given in \eqref{modeld}  and \eqref{model_elastic_substrate}.
%
% $W = \int_{\Omega_{0}} \phi  d\Omega_{0}$ is accomplished using a variant of conjugate gradient optimization known as the L-BFGS algorithm [98]. This algorithm seeks solutions to the equilibrium equations $\partial W / \partial \mathbf{u}{ij} = \int_{\Omega_{0}} \mathbf{P} \nabla \mathcal{N}_{ij} , d\Omega_{0} = 0$, where $\mathbf{P} = \partial \phi / \partial \boldsymbol{\nabla} \mathbf{y}$ and $\mathcal{N}_{ij}$ is the shape function at node $(ij)$. 

%unknown constants (cubic Hermite interpolation) (Liu and Quek, 2013). This implies that four shape functions were used in each
%two-node element (4 degrees of freedom), and we utilized a uniform mesh with an element size hùëí = 1‚àï1000. The discrete solution
%ùë¢‚Ä≤(ùë•ùëñ) provided at discrete nodes ùë•ùëñ by AUTO was first interpolated using B-spline basis function of degree 3 (Grimstad and others,
%2015) and then used to calculate the integral (10) using a three-point Gauss integration scheme; the fixed boundary conditions were
%imposed by removing from the stiffness matrix ùêä the row and columns at ùë• = 0 and ùë• = 1.



%\begin{algorithm}
%\caption{Monolithic minimization of the energy functional in the strain interval $[\bar\epsilon,\bar\epsilon+\delta\bar\epsilon]$}
%\LinesNumbered
%\SetAlgoNlRelativeSize{0}
%\SetNlSty{textbf}{(}{)}
%\SetAlgoNlRelativeSize{-1}
%\SetAlgoNlRelativeSize{1}
%
%\textbf{}Given ${\bf X}^n = \{{\bf u}^n, \alpha^n \}$ at $\bar\epsilon$ \\
%\textbf{}Set $\bar\epsilon$ to $\bar\epsilon+\delta\bar\epsilon$, with $\delta\bar\epsilon=10^{-6}$\\
%\textbf{}Set ${\bf X}^{n,0} \leftarrow {\bf X}^n$, $a \leftarrow 0$
%
%\While{$|\Psi_{\text{total}}^{n,a+1} - \Psi_{\text{total}}^{n,a}| \leq \text{TOL} \ll 1$}{
%    $\min\limits_{{\bf X}^{n,a+1}} \Psi_{\text{internal}}({\bf X}^{n,a+1}$)\;
%    %subject to $\alpha^{n,a+1} \geq \alpha^n$\;
%    \textbf{} Set $a \leftarrow a + 1$
%}
%\textbf{}Update solution: ${\bf X}^{n+1} \leftarrow {\bf X}^{n,a}$
%\end{algorithm}


%\begin{algorithm}
%\caption{Monolithic minimization of the energy functional in the strain interval $[\bar\epsilon,\bar\epsilon+\delta\bar\epsilon]$}
%\LinesNumbered
%\SetAlgoNlRelativeSize{0}
%\SetNlSty{textbf}{(}{)}
%\SetAlgoNlRelativeSize{-1}
%\SetAlgoNlRelativeSize{1}
%
%\textbf{}Given ${\bf X}^n = \{{\bf u}^n, \alpha^n \}$ at $\bar\epsilon$ \\
%\textbf{}Set $\bar\epsilon$ to $\bar\epsilon+\delta\bar\epsilon$, with $\delta\bar\epsilon=10^{-6}$\\
%\textbf{}Set ${\bf X}^{n,0} \leftarrow {\bf X}^n$, $a \leftarrow 0$
%
%\While{$|\Psi_{\text{total}}^{n,a+1} - \Psi_{\text{total}}^{n,a}| \leq \text{TOL} \ll 1$}{
%    $\min\limits_{{\bf X}^{n,a+1}} \Psi_{\text{internal}}({\bf X}^{n,a+1}$)\;
%    subject to $\alpha^{n,a+1} \geq \alpha^n$\;
%    \textbf{}Set $a \leftarrow a + 1$
%}
%\textbf{}Update solution: ${\bf X}^{n+1} \leftarrow {\bf X}^{n,a}$
%\end{algorithm}
%
%\begin{algorithm}
%\caption{Alternating minimization of the energy functional in the strain interval $[\bar\epsilon,\bar\epsilon+\delta\bar\epsilon]$}
%\LinesNumbered
%\SetAlgoNlRelativeSize{0}
%\SetNlSty{textbf}{(}{)}
%\SetAlgoNlRelativeSize{-1}
%\SetAlgoNlRelativeSize{1}
%
%\textbf{}Given ${\bf u}^n$, $\alpha^n$ at $\bar\epsilon$ \\
%\textbf{}Set $\bar\epsilon$ to $\bar\epsilon+\delta\bar\epsilon$, with $\delta\bar\epsilon=10^{-6}$\\
%\textbf{}Set ${\bf u}^{n,0} \leftarrow {\bf u}^n$, $\alpha^{n,0} \leftarrow \alpha^n$, $a \leftarrow 0$
%
%\While{$|\Psi_{\text{total}}^{n,a+1} - \Psi_{\text{total}}^{n,a}| \leq \text{TOL} \ll 1$}{
%    $\min\limits_{{\bf u}^{n,a+1}} \Psi_{\text{internal}}({\bf u}^{n,a+1}, \alpha^{n,a}$)\;
%    $\min\limits_{\alpha^{n,a+1}} \Psi_{\text{internal}}({\bf u}^{n,a+1}, \alpha^{n,a+1})$\;
%    subject to $\alpha^{n,a+1} \geq \alpha^n$\;
%    \textbf{}Set $a \leftarrow a + 1$
%}
%\textbf{}Update solution: ${\bf u}^{n+1} \leftarrow {\bf u}^{n,a}$, $\alpha^{n+1} \leftarrow \alpha^{n,a}$
%\end{algorithm}



\paragraph{Figures}

\begin{figure}[htbp]
    \centering
    \includegraphics*[width=.45\textwidth]{../images/model_stiff_energy.png}
    \includegraphics*[width=.45\textwidth]{../images/model_compliant_energy.png}
    \caption{
        Energy diagram of equilibrium branches in the phase-field model of an elastic bar on stiff (left) and compliant (right) elastic foundation. In the figure, the difference $\Delta \Psi = \Psi(y_t)-\Psi_h$ between the energy of the state $y_t$ on the current branch and the homogeneous solution. Stability of solutions is indicated by colors: blue and orange indicate, respectively, stable and unstable states, by numerical evaluation of the sign of the smallest eigenvalue of the stiffness matrix $\mathbf{K}^1$. According to the local energy minimality protocol, arrows indicate the anticipated branch switching events associated with the loss of stability at load values denoted $\bar \epsilon_j, j \in \mathbb N$, where $j$ indicates the instability mode, cf. Equation~\eqref{}. Letters correspond to the states depicted in Figure XXX.\todo[inline]{maybe change letters into numbers, indicating the number of the mode}%
    }
    \label{fig:}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics*[width=.45\textwidth]{../images/model_stiff_energy_kick.png}
    \includegraphics*[width=.45\textwidth]{../images/model_compliant_energy_kick.png}
    \caption{Quasi-static evolutions computed with L-BFGS fail to satisfy a local minimality criterion. The evolutions are displayed with a thick black line for the stiff substrate (left) and compliant substrate (right) models. The figures display the energy difference $\Delta \Psi = \Psi(y_t)-\Psi_h$ between the quasi-Newton solutions $y_t$ and the homogeneous state corresponding to the same load. At the bottom with a thin black line, the minimum eigenvalue $\lambda_t$ for the current state and the regions (highlighted in red) of instability.}
    \label{fig:}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics*[width=.45\textwidth]{../images/model_stiff_kick_profiles.png}
    \includegraphics*[width=.45\textwidth]{../images/model_compliant_kick_profiles.png}
    \caption{
        Profile of damage field showing the effect of the kick algorithm to transition from unstable to stable states. Branch switching events correspond to load values indicated by $\bar \epsilon_j$ with $j\in \mathbb N$ in Figure XXX, for the stiff substrate model (left column) and for the compliant substrate model (right column). %
        In the figures, the light (orange) line indicates the unstable damage field $\alpha^*$, the eigenvector associated to the smallest eigenvalue, $p$, is displayed in green highlighting its positive and negative values, the dashed line represents the perturbed damage field  $\alpha^*+p$ used as initial guess for the state transition, the solid black line displays the solution $\alpha$ returned by the quasi-Newton algorithm after convergence.}
    \label{fig:}
\end{figure}
\begin{figure}[htbp]
    \centering
    \includegraphics*[width=.45\textwidth]{../images/model_stiff_profiles.png}
    \includegraphics*[width=.45\textwidth]{../images/model_compliant_profiles.png}
    \caption{The damage profiles of the minimum energy configurations on each branch for the stiff (left) and compliant (right) substrate models. \todo[inline]{add markers}.}
    \label{fig:}
\end{figure}
\begin{figure}[htbp]
    \centering
    \includegraphics*[width=.45\textwidth]{../images/model_stiff_spectrum.png}
    \includegraphics*[width=.45\textwidth]{../images/model_compliant_spectrum.png}
    \caption{<caption>}
    \label{fig:}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics*[width=.45\textwidth]{../images/model_stiff_fields.png}
    \includegraphics*[width=.45\textwidth]{../images/model_compliant_fields.png}
    \caption{The damage and strain profiles computed along the evolution, for the stiff (left) and compliant (right) substrate models. The profiles correspond to the states marked $...$ in Figure XXX. Notice the peaks of strain in correspondence with the peaks of damage, and the localization of the strain in bands that are narrower than for the dmage field. Strain relaxes across a wider region in the compliant substrate model.}
    \label{fig:}
\end{figure}